<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¯Ø³ØªÛŒØ§Ø± Ø¨Ù†Ø¯Ú¯ÛŒ</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Vazirmatn', sans-serif; }
        :root {
            --bg-primary: #f0fdf4;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --text-primary: #064e3b;
            --text-secondary: #047857;
            --border-color: #a7f3d0;
            --accent: #059669;
        }
        .dark {
            --bg-primary: #022c22;
            --bg-secondary: #064e3b;
            --bg-card: #065f46;
            --text-primary: #ecfdf5;
            --text-secondary: #a7f3d0;
            --border-color: #047857;
            --accent: #34d399;
        }
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
        }
        .nav-item.active {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
        }
        .islamic-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23059669' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .toast {
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
        }
        @keyframes slideIn {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .checkbox-custom:checked {
            background: #059669;
            border-color: #059669;
        }
        input[type="checkbox"] {
            accent-color: #059669;
        }
        select {
            background: var(--bg-card);
            color: var(--text-primary);
            border-color: var(--border-color);
        }
        .counter-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .counter-btn:active {
            transform: scale(0.9);
        }
        .nav-arrow {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);
            flex-shrink: 0;
        }
        .nav-arrow:hover {
            transform: scale(1.1);
        }
        .nav-arrow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .tab-btn {
            padding: 8px 20px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 14px;
        }
        .tab-btn.active {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
        }
        .tab-btn:not(.active) {
            background: var(--bg-primary);
            color: var(--text-secondary);
        }
        .toggle-switch {
            position: relative;
            width: 56px;
            height: 28px;
            flex-shrink: 0;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 28px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            right: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #059669;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(-28px);
        }
    </style>
</head>
<body class="islamic-pattern min-h-screen pb-20">
    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 hidden">
        <div class="toast bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯</span>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-gradient-to-r from-green-700 via-emerald-600 to-green-700 text-white p-4 shadow-lg">
        <div class="text-center">
            <h1 class="text-2xl font-bold flex items-center justify-center gap-2">
                <span>â˜ª</span>
                <span>Ø¯Ø³ØªÛŒØ§Ø± Ø¨Ù†Ø¯Ú¯ÛŒ</span>
                <span>â˜ª</span>
            </h1>
            <p id="currentDate" class="text-green-100 text-sm mt-1"></p>
        </div>
    </header>

    <!-- Hadith Section -->
    <div class="mx-4 mt-4">
        <div class="card rounded-2xl p-4 shadow-md">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-2xl">ğŸ“¿</span>
                <span class="font-bold text-sm" style="color: var(--text-secondary)">Ø­Ø¯ÛŒØ« Ø±ÙˆØ²Ø§Ù†Ù‡ Ø§Ø² Ø§Ù…ÛŒØ±Ø§Ù„Ù…Ø¤Ù…Ù†ÛŒÙ† Ø¹Ù„ÛŒ (Ø¹)</span>
            </div>
            <p id="dailyHadith" class="text-sm leading-relaxed" style="color: var(--text-primary)"></p>
        </div>
    </div>

    <!-- Date Navigation (Only for Daily Tab) -->
    <div id="dateNavigation" class="mx-4 mt-4">
        <div class="card rounded-2xl p-3 shadow-md flex items-center justify-between">
            <button onclick="navigateDate(1)" class="nav-arrow">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
            <div class="text-center">
                <p id="selectedDateDisplay" class="font-bold" style="color: var(--text-primary)"></p>
                <p id="selectedDayName" class="text-xs" style="color: var(--text-secondary)"></p>
            </div>
            <button id="prevDayBtn" onclick="navigateDate(-1)" class="nav-arrow">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="p-4" id="mainContent">
        <!-- Daily Section -->
        <section id="dailySection">
            <!-- Status Message -->
            <div id="statusMessage" class="hidden mb-4">
                <div class="card rounded-xl p-3 text-center border-2 border-amber-400 bg-amber-50 dark:bg-amber-900/30">
                    <p class="text-amber-700 dark:text-amber-300 text-sm font-medium" id="statusText"></p>
                </div>
            </div>

            <!-- Prayers Section -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span class="text-xl">ğŸ•Œ</span>
                    Ù†Ù…Ø§Ø²Ù‡Ø§ÛŒ ÛŒÙˆÙ…ÛŒÙ‡
                </h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 rounded-xl" style="background: var(--bg-primary)">
                        <span class="font-medium">Ù†Ù…Ø§Ø² ØµØ¨Ø­</span>
                        <select id="prayerFajr" class="rounded-lg px-3 py-2 text-sm border">
                            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                            <option value="ontime">Ø§ÙˆÙ„ ÙˆÙ‚Øª â˜€ï¸</option>
                            <option value="midtime">Ù…ÛŒØ§Ù† ÙˆÙ‚Øª ğŸŒ¤ï¸</option>
                            <option value="endtime">Ø¢Ø®Ø± ÙˆÙ‚Øª ğŸŒ…</option>
                            <option value="qaza">Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§ âŒ</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between p-3 rounded-xl" style="background: var(--bg-primary)">
                        <span class="font-medium">Ù†Ù…Ø§Ø² Ø¸Ù‡Ø±</span>
                        <select id="prayerZuhr" class="rounded-lg px-3 py-2 text-sm border">
                            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                            <option value="ontime">Ø§ÙˆÙ„ ÙˆÙ‚Øª â˜€ï¸</option>
                            <option value="midtime">Ù…ÛŒØ§Ù† ÙˆÙ‚Øª ğŸŒ¤ï¸</option>
                            <option value="endtime">Ø¢Ø®Ø± ÙˆÙ‚Øª ğŸŒ…</option>
                            <option value="qaza">Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§ âŒ</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between p-3 rounded-xl" style="background: var(--bg-primary)">
                        <span class="font-medium">Ù†Ù…Ø§Ø² Ù…ØºØ±Ø¨</span>
                        <select id="prayerMaghrib" class="rounded-lg px-3 py-2 text-sm border">
                            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                            <option value="ontime">Ø§ÙˆÙ„ ÙˆÙ‚Øª â˜€ï¸</option>
                            <option value="midtime">Ù…ÛŒØ§Ù† ÙˆÙ‚Øª ğŸŒ¤ï¸</option>
                            <option value="endtime">Ø¢Ø®Ø± ÙˆÙ‚Øª ğŸŒ…</option>
                            <option value="qaza">Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§ âŒ</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Duas Section -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span class="text-xl">ğŸ¤²</span>
                    Ø§Ø¯Ø¹ÛŒÙ‡ Ùˆ Ø²ÛŒØ§Ø±Ø§Øª
                </h3>
                <div class="grid grid-cols-2 gap-3">
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaAshura" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø¯Ø¹Ø§ÛŒ Ø¹Ø§Ø´ÙˆØ±Ø§</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaYasin" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø¢Ù„ ÛŒØ§Ø³ÛŒÙ†</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaAminAllah" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø§Ù…ÛŒÙ† Ø§Ù„Ù„Ù‡</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaSalawat" class="w-5 h-5 rounded">
                        <span class="text-sm">ØµÙ„ÙˆØ§Øª Ø­Ø¶Ø±Øª Ø²Ù‡Ø±Ø§</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaAhd" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø¯Ø¹Ø§ÛŒ Ø¹Ù‡Ø¯</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaKisa" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø­Ø¯ÛŒØ« Ú©Ø³Ø§</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaTawassul" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø²ÛŒØ§Ø±Øª ØªÙˆØ³Ù„</span>
                    </label>
                    <label class="flex items-center gap-2 p-3 rounded-xl cursor-pointer" style="background: var(--bg-primary)">
                        <input type="checkbox" id="duaKumayl" class="w-5 h-5 rounded">
                        <span class="text-sm">Ø¯Ø¹Ø§ÛŒ Ú©Ù…ÛŒÙ„</span>
                    </label>
                </div>
            </div>

            <!-- Quran Section -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span class="text-xl">ğŸ“–</span>
                    ØªÙ„Ø§ÙˆØª Ù‚Ø±Ø¢Ù† Ú©Ø±ÛŒÙ…
                </h3>
                <div class="flex items-center justify-center gap-4 p-3 rounded-xl" style="background: var(--bg-primary)">
                    <span class="text-sm">ØªØ¹Ø¯Ø§Ø¯ ØµÙØ­Ø§Øª:</span>
                    <div class="flex items-center gap-3">
                        <button onclick="changeQuranPages(-1)" class="counter-btn">âˆ’</button>
                        <span id="quranPages" class="text-2xl font-bold w-12 text-center" style="color: var(--accent)">0</span>
                        <button onclick="changeQuranPages(1)" class="counter-btn">+</button>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <button id="submitBtn" onclick="submitDaily()" class="w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2">
                <span>âœ“</span>
                <span id="submitBtnText">Ø«Ø¨Øª Ø§Ø¹Ù…Ø§Ù„ Ø±ÙˆØ²Ø§Ù†Ù‡</span>
            </button>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboardSection" class="hidden">
            <!-- Time Period Tabs -->
            <div class="flex justify-center gap-3 mb-4">
                <button onclick="switchDashboardTab('weekly')" id="tabWeekly" class="tab-btn active">
                    Û· Ø±ÙˆØ² Ø§Ø®ÛŒØ±
                </button>
                <button onclick="switchDashboardTab('monthly')" id="tabMonthly" class="tab-btn">
                    Û³Û° Ø±ÙˆØ² Ø§Ø®ÛŒØ±
                </button>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold text-green-600" id="statsOntimePrayers">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">Ù†Ù…Ø§Ø² Ø§ÙˆÙ„ ÙˆÙ‚Øª</p>
                </div>
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold text-yellow-500" id="statsMidtimePrayers">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">Ù†Ù…Ø§Ø² Ù…ÛŒØ§Ù† ÙˆÙ‚Øª</p>
                </div>
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold text-orange-400" id="statsEndtimePrayers">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">Ù†Ù…Ø§Ø² Ø¢Ø®Ø± ÙˆÙ‚Øª</p>
                </div>
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold text-red-600" id="statsQazaPrayers">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§</p>
                </div>
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold" style="color: var(--accent)" id="statsQuranPages">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">ØµÙØ­Ø§Øª Ù‚Ø±Ø¢Ù†</p>
                </div>
                <div class="card rounded-2xl p-4 text-center shadow-md">
                    <p class="text-3xl font-bold" style="color: var(--accent)" id="statsDuas">0</p>
                    <p class="text-xs mt-1" style="color: var(--text-secondary)">Ø§Ø¯Ø¹ÛŒÙ‡ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡</p>
                </div>
            </div>

            <!-- Line Chart -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span>ğŸ“ˆ</span>
                    <span id="chartTitle">Ø¹Ù…Ù„Ú©Ø±Ø¯ Û· Ø±ÙˆØ² Ø§Ø®ÛŒØ±</span>
                </h3>
                <canvas id="performanceChart" height="180"></canvas>
            </div>

            <!-- Prayer Quality Chart -->
            <div class="card rounded-2xl p-4 shadow-md">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span>ğŸ¥§</span>
                    ØªØ­Ù„ÛŒÙ„ Ú©ÛŒÙÛŒØª Ù†Ù…Ø§Ø²Ù‡Ø§
                </h3>
                <div class="flex justify-center">
                    <div style="max-width: 220px; max-height: 220px;">
                        <canvas id="prayerQualityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settingsSection" class="hidden">
            <!-- Dark Mode Toggle -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span>ğŸ¨</span>
                    ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¸Ø§Ù‡Ø±ÛŒ
                </h3>
                <div class="flex items-center justify-between p-3 rounded-xl" style="background: var(--bg-primary)">
                    <span>Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Scoring System -->
            <div class="card rounded-2xl p-4 shadow-md mb-4">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span>â­</span>
                    Ù†Ø¸Ø§Ù… Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ
                </h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù†Ù…Ø§Ø² Ø§ÙˆÙ„ ÙˆÙ‚Øª</span>
                        <span class="font-bold text-green-600">Û±Û° Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù†Ù…Ø§Ø² Ù…ÛŒØ§Ù† ÙˆÙ‚Øª</span>
                        <span class="font-bold text-yellow-500">Û· Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù†Ù…Ø§Ø² Ø¢Ø®Ø± ÙˆÙ‚Øª</span>
                        <span class="font-bold text-orange-400">Û´ Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§</span>
                        <span class="font-bold text-red-600">Û° Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù‡Ø± Ø¯Ø¹Ø§/Ø²ÛŒØ§Ø±Øª</span>
                        <span class="font-bold text-green-600">Ûµ Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                    <div class="flex justify-between p-2 rounded-lg" style="background: var(--bg-primary)">
                        <span>Ù‡Ø± ØµÙØ­Ù‡ Ù‚Ø±Ø¢Ù†</span>
                        <span class="font-bold text-green-600">Û³ Ø§Ù…ØªÛŒØ§Ø²</span>
                    </div>
                </div>
            </div>

            <!-- About Section -->
            <div class="card rounded-2xl p-4 shadow-md">
                <h3 class="font-bold mb-4 flex items-center gap-2" style="color: var(--text-primary)">
                    <span>â„¹ï¸</span>
                    Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§
                </h3>
                <p class="text-sm leading-relaxed mb-4" style="color: var(--text-secondary)">
                    Ø§ÛŒÙ† Ø§Ø«Ø± ØªÙˆØ³Ø· Ø´Ø±Ú©Øª Ø¬Ø§ÙˆØ¯Ø§Ù† Ú¯ÛŒÙ…Ø² Ø·Ø±Ø§Ø­ÛŒ Ùˆ Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø¬Ù‡Øª Ú©Ø³Ø¨ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ± Ø§Ø² Ù…Ø§ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.
                </p>
                <a href="https://javadcamback.github.io/Javdan_Games/" target="_blank" class="block w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 rounded-xl font-bold text-center">
                    Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø§Ø² Ø³Ø§ÛŒØª
                </a>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 shadow-2xl border-t border-gray-200 dark:border-gray-700 z-40" style="background: var(--bg-card); border-color: var(--border-color)">
        <div class="flex justify-around items-center py-2">
            <button onclick="showSection('daily')" class="nav-item active flex flex-col items-center p-2 rounded-xl transition-all" id="navDaily">
                <span class="text-xl">ğŸ“</span>
                <span class="text-xs mt-1">Ø«Ø¨Øª Ø±ÙˆØ²Ø§Ù†Ù‡</span>
            </button>
            <button onclick="showSection('dashboard')" class="nav-item flex flex-col items-center p-2 rounded-xl transition-all" id="navDashboard">
                <span class="text-xl">ğŸ“Š</span>
                <span class="text-xs mt-1">Ú©Ø§Ø±Ù†Ø§Ù…Ù‡ Ø§Ø¹Ù…Ø§Ù„</span>
            </button>
            <button onclick="showSection('settings')" class="nav-item flex flex-col items-center p-2 rounded-xl transition-all" id="navSettings">
                <span class="text-xl">âš™ï¸</span>
                <span class="text-xs mt-1">ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
            </button>
        </div>
    </nav>

    <script>
        // Hadiths from Imam Ali (AS)
        const hadiths = [
            "Ø§Ø±Ø²Ø´ Ù‡Ø± Ú©Ø³ Ø¨Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù‡Ù…Øª Ø§ÙˆØ³Øª.",
            "Ø²Ø¨Ø§Ù†Øª Ø±Ø§ Ù†Ú¯Ù‡Ø¯Ø§Ø± ØªØ§ Ø¹Ù…Ø±Øª Ø¯Ø±Ø§Ø² Ø´ÙˆØ¯.",
            "Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¹ÛŒØ¨ Ø¢Ù† Ø§Ø³Øª Ú©Ù‡ Ø¹ÛŒØ¨ÛŒ Ø±Ø§ Ø¨Ø± Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø¨Ú¯ÛŒØ±ÛŒ Ú©Ù‡ Ø®ÙˆØ¯ Ø¨Ù‡ Ø¢Ù† Ù…Ø¨ØªÙ„Ø§ÛŒÛŒ.",
            "Ø§ÛŒÙ…Ø§Ù† Ú†Ù‡Ø§Ø±Ù¾Ø§ÛŒÙ‡ Ø¯Ø§Ø±Ø¯: ØªÙˆÚ©Ù‘Ù„ Ø¨Ø± Ø®Ø¯Ø§ØŒ ÙˆØ§Ú¯Ø°Ø§Ø±Ø¯Ù† Ú©Ø§Ø± Ø¨Ù‡ Ø®Ø¯Ø§ØŒ ØªØ³Ù„ÛŒÙ… Ø¨Ù‡ Ø§Ù…Ø± Ø®Ø¯Ø§ Ùˆ Ø±Ø¶Ø§ Ø¨Ù‡ Ù‚Ø¶Ø§Ù‰ Ø§Ù„Ù‡Ù‰.",
            "ØµØ¨Ø± Ø¯Ùˆ Ú¯ÙˆÙ†Ù‡ Ø§Ø³Øª: ØµØ¨Ø± Ø¨Ø± Ø¢Ù†Ú†Ù‡ Ù†Ø§Ø®ÙˆØ´Ø§ÛŒÙ†Ø¯ Ø§Ø³Øª Ùˆ ØµØ¨Ø± Ø§Ø² Ø¢Ù†Ú†Ù‡ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒ.",
            "Ø¹Ù‚Ù„ Ù…Ø±Ø¯Ù… Ø¯Ø± Ø³Ø®Ù†Ø§Ù†Ø´Ø§Ù† Ù¾Ù†Ù‡Ø§Ù† Ø§Ø³Øª.",
            "Ù‡Ù†Ú¯Ø§Ù… ÙØªÙ†Ù‡ Ú†ÙˆÙ† Ø´ØªØ± Ø¯Ùˆ Ø³Ø§Ù„Ù‡ Ø¨Ø§Ø´ Ú©Ù‡ Ù†Ù‡ Ù¾Ø´ØªÙ‰ Ø¯Ø§Ø±Ø¯ ØªØ§ Ø³ÙˆØ§Ø±Ø´ Ø´ÙˆÙ†Ø¯ Ùˆ Ù†Ù‡ Ù¾Ø³ØªØ§Ù†Ù‰ ØªØ§ Ø´ÛŒØ±Ø´ Ø¯ÙˆØ´Ù†Ø¯.",
            "Ù…Ø±Ø¯Ù… Ø¯Ø´Ù…Ù† Ú†ÛŒØ²ÛŒ Ù‡Ø³ØªÙ†Ø¯ Ú©Ù‡ Ù†Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù†Ø¯.",
            "Ø§Ø² Ú¯Ù†Ø¬â€ŒÙ‡Ø§ÛŒ Ø¨Ù‡Ø´Øª Ù†ÛŒÚ©ÛŒ Ú©Ø±Ø¯Ù† Ùˆ Ù¾Ù†Ù‡Ø§Ù† Ù†Ù…ÙˆØ¯Ù† Ú©Ø§Ø± [Ù†ÛŒÚ©]Ùˆ ØµØ¨Ø± Ø¨Ø± Ù…ØµÛŒØ¨Øªâ€ŒÙ‡Ø§ Ùˆ Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ú¯Ø±ÙØªØ§Ø±ÛŒâ€ŒÙ‡Ø§ (ÛŒØ¹Ù†ÛŒ Ø¹Ø¯Ù… Ø´Ú©Ø§ÛŒØª Ø§Ø² Ø¢Ù†Ù‡Ø§) Ø§Ø³Øª",
            "Ù‡Ø± Ú©Ù‡ Ø§Ø² Ø®ÙˆØ¯ Ø±Ø§Ø¶ÛŒ Ø´Ø¯ØŒ Ø¨Ø¯Ú¯ÙˆÛŒØ§Ù† Ø¨Ø± Ø§Ùˆ Ø¨Ø³ÛŒØ§Ø± Ø´Ø¯Ù†Ø¯.",
            "Ø²Ø§Ù‡Ø¯ Ø¯Ø± Ø¯Ù†ÛŒØ§ Ú©Ø³ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø­Ø±Ø§Ù… Ø¨Ø± ØµØ¨Ø±Ø´ ØºÙ„Ø¨Ù‡ Ù†Ú©Ù†Ø¯ Ùˆ Ø­Ù„Ø§Ù„ Ø§Ø² Ø´Ú©Ø±Ø´ Ø¨Ø§Ø² Ù†Ø¯Ø§Ø±Ø¯.",
            "Ø¯Ù†ÛŒØ§ Ù…Ø­Ù„ Ø¢Ø²Ù…Ø§ÛŒØ´ Ø§Ø³Øª Ù†Ù‡ Ø¢Ø±Ø§Ù…Ø´.",
            "Ø¹Ù„Ù… Ø¨Ù‡ØªØ± Ø§Ø² Ù…Ø§Ù„ Ø§Ø³ØªØŒ Ø²ÛŒØ±Ø§ Ø¹Ù„Ù… ØªÙˆ Ø±Ø§ Ù†Ú¯Ù‡Ø¨Ø§Ù† Ø§Ø³Øª Ùˆ ØªÙˆ Ù…Ø§Ù„ Ø±Ø§ Ù†Ú¯Ù‡Ø¨Ø§Ù†ÛŒ.",
            "ÙØ±ØµØª Ú†ÙˆÙ† Ø§Ø¨Ø± Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ø¯ØŒ Ù¾Ø³ ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¨ Ø±Ø§ ØºÙ†ÛŒÙ…Øª Ø´Ù…Ø§Ø±ÛŒØ¯.",
            "ØªÙˆØ§Ø¶Ø¹ Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ø´Ø±Ø§ÙØª Ø§Ø³Øª.",
            "Ù†Ø§Ø¯Ø§Ù† Ø±Ø§ Ù†Ù‡ Ø¨Ø§ Ú¯ÙØªØ§Ø± Ùˆ Ù†Ù‡ Ø¨Ø§ Ø³Ú©ÙˆØª Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø§ØµÙ„Ø§Ø­ Ú©Ø±Ø¯.",
            "Ø³Ù‡ Ú†ÛŒØ² Ø±Ø§ Ø¨Ø§ Ø³Ù‡ Ú†ÛŒØ² Ø¨ÛŒØ§Ø²Ù…Ø§ÛŒÛŒØ¯: Ø´Ø¬Ø§Ø¹Øª Ø±Ø§ Ø¯Ø± Ø¬Ù†Ú¯ØŒ Ø§Ù…Ø§Ù†Øª Ø±Ø§ Ø¯Ø± Ù…Ø¹Ø§Ù…Ù„Ù‡ØŒ Ùˆ Ø¯ÙˆØ³ØªÛŒ Ø±Ø§ Ø¯Ø± Ú¯Ø±ÙØªØ§Ø±ÛŒ.",
            "Ø¢Ù† Ú©Ù‡ Ø¹ÛŒÙˆØ¨ Ù…Ø±Ø¯Ù… Ø±Ø§ Ø¨Ù†Ú¯Ø±Ø¯ Ùˆ Ø¢Ù† Ø±Ø§ Ù†Ø§Ù¾Ø³Ù†Ø¯ Ø¯Ø§Ù†Ø¯ Ø³Ù¾Ø³ Ø¨Ø±Ø§Ù‰ Ø®ÙˆØ¯ Ø±ÙˆØ§ Ø¯Ø§Ù†Ø¯ Ø§Ø­Ù…Ù‚ ÙˆØ§Ù‚Ø¹Ù‰ Ø§Ø³Øª.",
            "Ø¨Ø§ Ø¯ÙˆØ³ØªØª Ø¢Ø±Ø§Ù… Ø¨ÛŒØ§ØŒ Ú†Ù‡ Ø¨Ø³Ø§ Ú©Ù‡ Ø±ÙˆØ²ÛŒ Ø¯Ø´Ù…Ù†Øª Ø´ÙˆØ¯ Ùˆ Ø¨Ø§ Ø¯Ø´Ù…Ù†Øª Ø¢Ø±Ø§Ù… Ø¨ÛŒØ§ØŒ Ú†Ù‡ Ø¨Ø³Ø§ Ú©Ù‡ Ø±ÙˆØ²ÛŒ Ø¯ÙˆØ³ØªØª Ø´ÙˆØ¯.",
            "Ø¨Ø§ Ø¯Ø´Ù…Ù†Ù Ø¯ÙˆØ³ØªØª Ø¯ÙˆØ³Øª Ù…Ø´Ùˆ Ú©Ù‡ [Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø§Ø±]Ø¨Ø§ Ø¯ÙˆØ³ØªØª Ø¯Ø´Ù…Ù†ÛŒ Ù…ÛŒÚ©Ù†ÛŒ.",
            "Ø±Ø§Ø³ØªÚ¯ÙˆÛŒÛŒ Ø§Ù…Ø§Ù†Øª Ø§Ø³Øª Ùˆ Ø¯Ø±ÙˆØºÚ¯ÙˆÛŒÛŒ Ø®ÛŒØ§Ù†Øª.",
            "Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø³Ø®ØªÛŒâ€ŒÙ‡Ø§ ØµØ¨ÙˆØ± Ø¨Ø§Ø´ Ú©Ù‡ Ù¾Ø§ÛŒØ§Ù† Ù‡Ø± Ø³Ø®ØªÛŒ Ø¢Ø³Ø§Ù†ÛŒ Ø§Ø³Øª.",
            "Ø¢Ø¯Ù…ÛŒ Ø²ÛŒØ± Ø²Ø¨Ø§Ù† Ø®ÙˆØ¯ Ù¾Ù†Ù‡Ø§Ù† Ø§Ø³Øª.",
            "Ù‚Ù†Ø§Ø¹Øª Ú¯Ù†Ø¬ÛŒ Ø§Ø³Øª Ú©Ù‡ Ù¾Ø§ÛŒØ§Ù† Ù†Ù…ÛŒâ€ŒÙ¾Ø°ÛŒØ±Ø¯.",
            "Ø¯Ù„â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø§ Ù†ØµÛŒØ­Øª Ø²ÛŒØ§Ø¯ Ø®Ø³ØªÙ‡ Ù†Ú©Ù†ÛŒØ¯.",
            "Ø¯Ø± Ø´Ú¯ÙØªÙ… Ø§Ø² Ù…ØªÚ©Ø¨Ø± Ú©Ù‡ Ø¯ÛŒØ±ÙˆØ² Ù†Ø·ÙÙ‡ Ø¨ÙˆØ¯ Ùˆ ÙØ±Ø¯Ø§ Ù…Ø±Ø¯Ø§Ø± Ø§Ø³Øª.",
            "Ù‡Ø± Ú©Ø³ Ø¨Ù‡ Ø®ÙˆØ¯ Ù…ØºØ±ÙˆØ± Ø´ÙˆØ¯ØŒ Ù‡Ù„Ø§Ú© Ù…ÛŒâ€ŒØ´ÙˆØ¯.",
            "Ù†ÛŒÚ©ÛŒ Ú©Ù† Ùˆ Ø¨Ù‡ Ø¯Ø±ÛŒØ§ Ø§Ù†Ø¯Ø§Ø² Ú©Ù‡ Ø±ÙˆØ²ÛŒ Ø¨Ù‡ ØªÙˆ Ø¨Ø§Ø² Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.",
            "Ø³Ø®Ø§ÙˆØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ù…Ø±Ø¯Ù… Ú©Ø³ÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ù†Ø¨ÙˆØ¯ Ø®ÙˆØ¯ Ø¨Ø¨Ø®Ø´Ø¯.",
            "Ø³ØªÙ…Ú¯Ø± Ø±Ø§ Ø³Ù‡ Ù†Ø´Ø§Ù†Ù‡ Ø§Ø³Øª: Ø¨Ù‡ Ø²ÛŒØ±Ø¯Ø³ØªØ§Ù† Ø³ØªÙ… Ú©Ù†Ø¯ØŒ Ø¨Ù‡ Ø²Ø¨Ø±Ø¯Ø³ØªØ§Ù† Ù†Ø§ÙØ±Ù…Ø§Ù†ÛŒ Ùˆ Ø§Ø² Ø³ØªÙ…Ú¯Ø±Ø§Ù† Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ."
        ];

        // Persian date functions
        function toPersianNum(num) {
            const persianDigits = ['Û°', 'Û±', 'Û²', 'Û³', 'Û´', 'Ûµ', 'Û¶', 'Û·', 'Û¸', 'Û¹'];
            return num.toString().replace(/\d/g, d => persianDigits[d]);
        }

        function getPersianDate(date = new Date()) {
            const options = { calendar: 'persian', year: 'numeric', month: 'long', day: 'numeric' };
            return new Intl.DateTimeFormat('fa-IR', options).format(date);
        }

        function getPersianDateKey(date = new Date()) {
            const options = { calendar: 'persian', year: 'numeric', month: '2-digit', day: '2-digit' };
            return new Intl.DateTimeFormat('fa-IR-u-nu-latn', options).format(date);
        }

        function getPersianDayName(date = new Date()) {
            const days = ['ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡', 'Ø´Ù†Ø¨Ù‡'];
            return days[date.getDay()];
        }

        // State
        let currentDate = new Date();
        let selectedDate = new Date();
        let quranPagesCount = 0;
        let performanceChart = null;
        let prayerQualityChart = null;
        let currentDashboardTab = 'weekly';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadDarkMode();
            updateDateDisplay();
            loadDailyData();
            setRandomHadith();
            updateDashboard();
        });

        function setRandomHadith() {
            const today = new Date();
            const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
            const index = seed % hadiths.length;
            document.getElementById('dailyHadith').textContent = hadiths[index];
        }

        function updateDateDisplay() {
            document.getElementById('currentDate').textContent = getPersianDate(currentDate);
            document.getElementById('selectedDateDisplay').textContent = getPersianDate(selectedDate);
            document.getElementById('selectedDayName').textContent = getPersianDayName(selectedDate);
            
            // Check if selected date is in the future
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const selected = new Date(selectedDate);
            selected.setHours(0, 0, 0, 0);
            
            const isFuture = selected > today;
            const isToday = selected.getTime() === today.getTime();
            
            // Update navigation button state
            document.getElementById('prevDayBtn').disabled = isFuture;
        }

        function navigateDate(direction) {
            const newDate = new Date(selectedDate);
            newDate.setDate(newDate.getDate() + direction);
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            newDate.setHours(0, 0, 0, 0);
            
            // Don't allow future dates
            if (newDate > today) {
                return;
            }
            
            selectedDate = newDate;
            updateDateDisplay();
            loadDailyData();
        }

        function loadDailyData() {
            const dateKey = getPersianDateKey(selectedDate);
            const data = JSON.parse(localStorage.getItem('religiousData') || '{}');
            const dayData = data[dateKey] || {};
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const selected = new Date(selectedDate);
            selected.setHours(0, 0, 0, 0);
            
            const isToday = selected.getTime() === today.getTime();
            const isPast = selected < today;
            const isSubmitted = dayData.submitted === true;
            
            // Set form values
            document.getElementById('prayerFajr').value = dayData.prayerFajr || '';
            document.getElementById('prayerZuhr').value = dayData.prayerZuhr || '';
            document.getElementById('prayerMaghrib').value = dayData.prayerMaghrib || '';
            
            document.getElementById('duaAshura').checked = dayData.duaAshura || false;
            document.getElementById('duaYasin').checked = dayData.duaYasin || false;
            document.getElementById('duaAminAllah').checked = dayData.duaAminAllah || false;
            document.getElementById('duaSalawat').checked = dayData.duaSalawat || false;
            document.getElementById('duaAhd').checked = dayData.duaAhd || false;
            document.getElementById('duaKisa').checked = dayData.duaKisa || false;
            document.getElementById('duaTawassul').checked = dayData.duaTawassul || false;
            document.getElementById('duaKumayl').checked = dayData.duaKumayl || false;
            
            quranPagesCount = dayData.quranPages || 0;
            document.getElementById('quranPages').textContent = toPersianNum(quranPagesCount);
            
            // Handle form state
            const statusMsg = document.getElementById('statusMessage');
            const statusText = document.getElementById('statusText');
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            
            const formElements = [
                document.getElementById('prayerFajr'),
                document.getElementById('prayerZuhr'),
                document.getElementById('prayerMaghrib'),
                document.getElementById('duaAshura'),
                document.getElementById('duaYasin'),
                document.getElementById('duaAminAllah'),
                document.getElementById('duaSalawat'),
                document.getElementById('duaAhd'),
                document.getElementById('duaKisa'),
                document.getElementById('duaTawassul'),
                document.getElementById('duaKumayl')
            ];
            
            if (isSubmitted) {
                statusMsg.classList.remove('hidden');
                statusText.textContent = 'Ø§Ø¹Ù…Ø§Ù„ Ø§ÛŒÙ† Ø±ÙˆØ² Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ùˆ Ù‚Ø§Ø¨Ù„ ØªØºÛŒÛŒØ± Ù†ÛŒØ³Øª.';
                submitBtn.disabled = true;
                submitBtn.classList.add('opacity-50');
                submitBtnText.textContent = 'Ø«Ø¨Øª Ø´Ø¯Ù‡ âœ“';
                formElements.forEach(el => el.disabled = true);
                disableQuranButtons(true);
            } else if (isPast) {
                statusMsg.classList.remove('hidden');
                statusText.textContent = 'Ø§ÛŒÙ† Ø±ÙˆØ² Ú¯Ø°Ø´ØªÙ‡ Ùˆ Ø§Ø¹Ù…Ø§Ù„ Ø¢Ù† Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯.';
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-50');
                submitBtnText.textContent = 'Ø«Ø¨Øª Ø§Ø¹Ù…Ø§Ù„ Ø±ÙˆØ²Ø§Ù†Ù‡';
                formElements.forEach(el => el.disabled = false);
                disableQuranButtons(false);
            } else if (isToday) {
                statusMsg.classList.add('hidden');
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-50');
                submitBtnText.textContent = 'Ø«Ø¨Øª Ø§Ø¹Ù…Ø§Ù„ Ø±ÙˆØ²Ø§Ù†Ù‡';
                formElements.forEach(el => el.disabled = false);
                disableQuranButtons(false);
            }
        }

        function disableQuranButtons(disabled) {
            const buttons = document.querySelectorAll('.counter-btn');
            buttons.forEach(btn => {
                btn.style.opacity = disabled ? '0.5' : '1';
                btn.style.pointerEvents = disabled ? 'none' : 'auto';
            });
        }

        function changeQuranPages(delta) {
            quranPagesCount = Math.max(0, quranPagesCount + delta);
            document.getElementById('quranPages').textContent = toPersianNum(quranPagesCount);
        }

        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        function submitDaily() {
            const dateKey = getPersianDateKey(selectedDate);
            const data = JSON.parse(localStorage.getItem('religiousData') || '{}');
            
            data[dateKey] = {
                prayerFajr: document.getElementById('prayerFajr').value,
                prayerZuhr: document.getElementById('prayerZuhr').value,
                prayerMaghrib: document.getElementById('prayerMaghrib').value,
                duaAshura: document.getElementById('duaAshura').checked,
                duaYasin: document.getElementById('duaYasin').checked,
                duaAminAllah: document.getElementById('duaAminAllah').checked,
                duaSalawat: document.getElementById('duaSalawat').checked,
                duaAhd: document.getElementById('duaAhd').checked,
                duaKisa: document.getElementById('duaKisa').checked,
                duaTawassul: document.getElementById('duaTawassul').checked,
                duaKumayl: document.getElementById('duaKumayl').checked,
                quranPages: quranPagesCount,
                submitted: true,
                date: dateKey
            };
            
            localStorage.setItem('religiousData', JSON.stringify(data));
            
            showToast();
            loadDailyData();
            updateDashboard();
        }

        function showSection(section) {
            document.getElementById('dailySection').classList.add('hidden');
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
            document.getElementById('dateNavigation').classList.add('hidden');
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            
            if (section === 'daily') {
                document.getElementById('dailySection').classList.remove('hidden');
                document.getElementById('dateNavigation').classList.remove('hidden');
                document.getElementById('navDaily').classList.add('active');
            } else if (section === 'dashboard') {
                document.getElementById('dashboardSection').classList.remove('hidden');
                document.getElementById('navDashboard').classList.add('active');
                updateDashboard();
            } else if (section === 'settings') {
                document.getElementById('settingsSection').classList.remove('hidden');
                document.getElementById('navSettings').classList.add('active');
            }
        }

        function switchDashboardTab(tab) {
            currentDashboardTab = tab;
            document.getElementById('tabWeekly').classList.toggle('active', tab === 'weekly');
            document.getElementById('tabMonthly').classList.toggle('active', tab === 'monthly');
            document.getElementById('chartTitle').textContent = tab === 'weekly' ? 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Û· Ø±ÙˆØ² Ø§Ø®ÛŒØ±' : 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Û³Û° Ø±ÙˆØ² Ø§Ø®ÛŒØ±';
            updateDashboard();
        }

        function updateDashboard() {
            const data = JSON.parse(localStorage.getItem('religiousData') || '{}');
            const days = currentDashboardTab === 'weekly' ? 7 : 30;
            
            // Calculate stats
            let ontime = 0, midtime = 0, endtime = 0, qaza = 0;
            let duas = 0, quran = 0;
            
            const chartData = [];
            const prayerQuality = { ontime: 0, midtime: 0, endtime: 0, qaza: 0 };
            
            for (let i = 0; i < days; i++) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateKey = getPersianDateKey(date);
                const dayData = data[dateKey] || {};
                
                const prayers = [dayData.prayerFajr, dayData.prayerZuhr, dayData.prayerMaghrib];
                const ontimeCount = prayers.filter(p => p === 'ontime').length;
                const midtimeCount = prayers.filter(p => p === 'midtime').length;
                const endtimeCount = prayers.filter(p => p === 'endtime').length;
                const qazaCount = prayers.filter(p => p === 'qaza').length;
                
                const duaCount = [
                    dayData.duaAshura, dayData.duaYasin, dayData.duaAminAllah,
                    dayData.duaSalawat, dayData.duaAhd, dayData.duaKisa,
                    dayData.duaTawassul, dayData.duaKumayl
                ].filter(Boolean).length;
                
                const quranPages = dayData.quranPages || 0;
                
                ontime += ontimeCount;
                midtime += midtimeCount;
                endtime += endtimeCount;
                qaza += qazaCount;
                duas += duaCount;
                quran += quranPages;
                
                prayerQuality.ontime += ontimeCount;
                prayerQuality.midtime += midtimeCount;
                prayerQuality.endtime += endtimeCount;
                prayerQuality.qaza += qazaCount;
                
                // Calculate daily score based on scoring system
                const prayerScore = (ontimeCount * 10) + (midtimeCount * 7) + (endtimeCount * 4) + (qazaCount * 0);
                const duaScore = duaCount * 5;
                const quranScore = quranPages * 3;
                const dailyScore = prayerScore + duaScore + quranScore;
                
                chartData.unshift({
                    day: currentDashboardTab === 'weekly' ? getPersianDayName(date).substring(0, 3) : toPersianNum(i + 1),
                    score: dailyScore
                });
            }
            
            // Update stats display
            document.getElementById('statsOntimePrayers').textContent = toPersianNum(ontime);
            document.getElementById('statsMidtimePrayers').textContent = toPersianNum(midtime);
            document.getElementById('statsEndtimePrayers').textContent = toPersianNum(endtime);
            document.getElementById('statsQazaPrayers').textContent = toPersianNum(qaza);
            document.getElementById('statsQuranPages').textContent = toPersianNum(quran);
            document.getElementById('statsDuas').textContent = toPersianNum(duas);
            
            // Update charts
            updatePerformanceChart(chartData);
            updatePrayerQualityChart(prayerQuality);
        }

        function updatePerformanceChart(data) {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            const isDark = document.body.classList.contains('dark');
            const textColor = isDark ? '#a7f3d0' : '#064e3b';
            const gridColor = isDark ? 'rgba(167, 243, 208, 0.2)' : 'rgba(6, 78, 59, 0.1)';
            
            if (performanceChart) {
                performanceChart.destroy();
            }
            
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(d => d.day),
                    datasets: [
                        {
                            label: 'Ø§Ù…ØªÛŒØ§Ø² Ø±ÙˆØ²Ø§Ù†Ù‡',
                            data: data.map(d => d.score),
                            borderColor: '#059669',
                            backgroundColor: 'rgba(5, 150, 105, 0.2)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 5,
                            pointBackgroundColor: '#059669',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            borderWidth: 3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                color: textColor,
                                font: {
                                    family: 'Vazirmatn'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: textColor
                            },
                            grid: {
                                color: gridColor
                            }
                        },
                        x: {
                            ticks: {
                                color: textColor
                            },
                            grid: {
                                color: gridColor
                            }
                        }
                    }
                }
            });
        }

        function updatePrayerQualityChart(data) {
            const ctx = document.getElementById('prayerQualityChart').getContext('2d');
            const isDark = document.body.classList.contains('dark');
            const textColor = isDark ? '#a7f3d0' : '#064e3b';
            
            if (prayerQualityChart) {
                prayerQualityChart.destroy();
            }
            
            prayerQualityChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Ø§ÙˆÙ„ ÙˆÙ‚Øª', 'Ù…ÛŒØ§Ù† ÙˆÙ‚Øª', 'Ø¢Ø®Ø± ÙˆÙ‚Øª', 'Ù†Ù…Ø§Ø² Ù‚Ø¶Ø§'],
                    datasets: [{
                        data: [data.ontime, data.midtime, data.endtime, data.qaza],
                        backgroundColor: ['#059669', '#eab308', '#f97316', '#dc2626'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                color: textColor,
                                font: {
                                    size: 11,
                                    family: 'Vazirmatn'
                                },
                                padding: 10
                            }
                        }
                    }
                }
            });
        }

        function toggleDarkMode() {
            const isDark = document.getElementById('darkModeToggle').checked;
            document.documentElement.classList.toggle('dark', isDark);
            document.body.classList.toggle('dark', isDark);
            localStorage.setItem('darkMode', isDark);
            // Update charts with new colors
            updateDashboard();
        }

        function loadDarkMode() {
            const isDark = localStorage.getItem('darkMode') === 'true';
            document.getElementById('darkModeToggle').checked = isDark;
            document.documentElement.classList.toggle('dark', isDark);
            document.body.classList.toggle('dark', isDark);
        }
    </script>
</body>
</html>
